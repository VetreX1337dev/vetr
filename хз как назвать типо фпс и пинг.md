local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Создание основного ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MonotonClient"
screenGui.DisplayOrder = 10
screenGui.IgnoreGuiInset = true
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Основной контейнер для всей HUD (ПОНИЖЕ)
local mainContainer = Instance.new("Frame")
mainContainer.Name = "MainContainer"
mainContainer.Size = UDim2.new(0, 360, 0, 130)
mainContainer.Position = UDim2.new(0, 20, 0, 58) -- ПОНИЖЕ (было 20→35)
mainContainer.BackgroundTransparency = 1
mainContainer.Parent = screenGui

-- ============ БЛОК СКИНА ============
local skinContainer = Instance.new("Frame")
skinContainer.Name = "SkinContainer"
skinContainer.Size = UDim2.new(0, 110, 0, 110)
skinContainer.Position = UDim2.new(0, 0, 0, 0)
skinContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
skinContainer.BorderSizePixel = 0
skinContainer.BackgroundTransparency = 0.05
skinContainer.Parent = mainContainer

local skinCorner = Instance.new("UICorner")
skinCorner.CornerRadius = UDim.new(0, 6)
skinCorner.Parent = skinContainer

local skinStroke = Instance.new("UIStroke")
skinStroke.Color = Color3.fromRGB(60, 60, 60)
skinStroke.Thickness = 1.5
skinStroke.Transparency = 0.3
skinStroke.Parent = skinContainer

-- Внутренний контейнер для скина с отступом
local skinInner = Instance.new("Frame")
skinInner.Name = "SkinInner"
skinInner.Size = UDim2.new(1, -10, 1, -10)
skinInner.Position = UDim2.new(0, 5, 0, 5)
skinInner.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
skinInner.BorderSizePixel = 0
skinInner.Parent = skinContainer

local skinInnerCorner = Instance.new("UICorner")
skinInnerCorner.CornerRadius = UDim.new(0, 4)
skinInnerCorner.Parent = skinInner

-- Изображение скина (РОВНО В КВАДРАТ)
local skinImage = Instance.new("ImageLabel")
skinImage.Name = "SkinImage"
skinImage.Size = UDim2.new(1, 0, 1, 0)
skinImage.Position = UDim2.new(0, 0, 0, 0)
skinImage.BackgroundTransparency = 1
skinImage.ScaleType = Enum.ScaleType.Crop
skinImage.ResampleMode = Enum.ResamplerMode.Pixelated
skinImage.Parent = skinInner

-- Загружаем квадратную иконку игрока
local userId = player.UserId
skinImage.Image = "https://www.roblox.com/headshot-thumbnail/image?userId=" .. userId .. "&width=420&height=420&format=png"

-- ============ БЛОК FPS ============
local fpsContainer = Instance.new("Frame")
fpsContainer.Name = "FPSContainer"
fpsContainer.Size = UDim2.new(0, 110, 0, 35)
fpsContainer.Position = UDim2.new(0, 120, 0, 2)
fpsContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
fpsContainer.BorderSizePixel = 0
fpsContainer.BackgroundTransparency = 0.05
fpsContainer.Parent = mainContainer

local fpsCorner = Instance.new("UICorner")
fpsCorner.CornerRadius = UDim.new(0, 6)
fpsCorner.Parent = fpsContainer

local fpsStroke = Instance.new("UIStroke")
fpsStroke.Color = Color3.fromRGB(60, 60, 60)
fpsStroke.Thickness = 1.5
fpsStroke.Transparency = 0.3
fpsStroke.Parent = fpsContainer

-- ГЛЮР для FPS
local fpsBlur = Instance.new("BlurEffect")
fpsBlur.Size = 4
fpsBlur.Parent = fpsContainer

-- Внутренний контейнер для FPS
local fpsInner = Instance.new("Frame")
fpsInner.Name = "FPSInner"
fpsInner.Size = UDim2.new(1, -10, 1, -10)
fpsInner.Position = UDim2.new(0, 5, 0, 5)
fpsInner.BackgroundTransparency = 1
fpsInner.Parent = fpsContainer

-- Заголовок FPS
local fpsTitle = Instance.new("TextLabel")
fpsTitle.Name = "FPSTitle"
fpsTitle.Size = UDim2.new(0, 35, 1, 0)
fpsTitle.Position = UDim2.new(0, 0, 0, 0)
fpsTitle.BackgroundTransparency = 1
fpsTitle.Text = "FPS:"
fpsTitle.TextColor3 = Color3.fromRGB(180, 180, 180)
fpsTitle.TextSize = 15
fpsTitle.Font = Enum.Font.SourceSansSemibold
fpsTitle.TextXAlignment = Enum.TextXAlignment.Left
fpsTitle.Parent = fpsInner

-- Значение FPS
local fpsValue = Instance.new("TextLabel")
fpsValue.Name = "FPSValue"
fpsValue.Size = UDim2.new(0, 65, 1, 0)
fpsValue.Position = UDim2.new(0, 38, 0, 0)
fpsValue.BackgroundTransparency = 1
fpsValue.Text = "--"
fpsValue.TextColor3 = Color3.fromRGB(100, 255, 100)
fpsValue.TextSize = 15
fpsValue.Font = Enum.Font.SourceSansBold
fpsValue.TextXAlignment = Enum.TextXAlignment.Left
fpsValue.Parent = fpsInner

-- ============ БЛОК PING ============
local pingContainer = Instance.new("Frame")
pingContainer.Name = "PingContainer"
pingContainer.Size = UDim2.new(0, 110, 0, 35)
pingContainer.Position = UDim2.new(0, 235, 0, 2)
pingContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
pingContainer.BorderSizePixel = 0
pingContainer.BackgroundTransparency = 0.05
pingContainer.Parent = mainContainer

local pingCorner = Instance.new("UICorner")
pingCorner.CornerRadius = UDim.new(0, 6)
pingCorner.Parent = pingContainer

local pingStroke = Instance.new("UIStroke")
pingStroke.Color = Color3.fromRGB(60, 60, 60)
pingStroke.Thickness = 1.5
pingStroke.Transparency = 0.3
pingStroke.Parent = pingContainer

-- ГЛЮР для PING
local pingBlur = Instance.new("BlurEffect")
pingBlur.Size = 4
pingBlur.Parent = pingContainer

-- Внутренний контейнер для PING
local pingInner = Instance.new("Frame")
pingInner.Name = "PingInner"
pingInner.Size = UDim2.new(1, -10, 1, -10)
pingInner.Position = UDim2.new(0, 5, 0, 5)
pingInner.BackgroundTransparency = 1
pingInner.Parent = pingContainer

-- Заголовок PING
local pingTitle = Instance.new("TextLabel")
pingTitle.Name = "PingTitle"
pingTitle.Size = UDim2.new(0, 45, 1, 0)
pingTitle.Position = UDim2.new(0, 0, 0, 0)
pingTitle.BackgroundTransparency = 1
pingTitle.Text = "PING:"
pingTitle.TextColor3 = Color3.fromRGB(220, 220, 220)
pingTitle.TextSize = 15
pingTitle.Font = Enum.Font.SourceSansSemibold
pingTitle.TextXAlignment = Enum.TextXAlignment.Left
pingTitle.Parent = pingInner

-- Значение PING
local pingValue = Instance.new("TextLabel")
pingValue.Name = "PingValue"
pingValue.Size = UDim2.new(0, 55, 1, 0)
pingValue.Position = UDim2.new(0, 48, 0, 0)
pingValue.BackgroundTransparency = 1
pingValue.Text = "--"
pingValue.TextColor3 = Color3.fromRGB(100, 255, 100)
pingValue.TextSize = 15
pingValue.Font = Enum.Font.SourceSansBold
pingValue.TextXAlignment = Enum.TextXAlignment.Left
pingValue.Parent = pingInner

-- ============ БЛОК HP ============
local hpContainer = Instance.new("Frame")
hpContainer.Name = "HPContainer"
hpContainer.Size = UDim2.new(0, 195, 0, 35)
hpContainer.Position = UDim2.new(0, 120, 0, 42)
hpContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
hpContainer.BorderSizePixel = 0
hpContainer.BackgroundTransparency = 0.05
hpContainer.Parent = mainContainer

local hpCorner = Instance.new("UICorner")
hpCorner.CornerRadius = UDim.new(0, 6)
hpCorner.Parent = hpContainer

local hpStroke = Instance.new("UIStroke")
hpStroke.Color = Color3.fromRGB(60, 60, 60)
hpStroke.Thickness = 1.5
hpStroke.Transparency = 0.3
hpStroke.Parent = hpContainer

-- ГЛЮР для HP
local hpBlur = Instance.new("BlurEffect")
hpBlur.Size = 4
hpBlur.Parent = hpContainer

-- Внутренний контейнер для HP
local hpInner = Instance.new("Frame")
hpInner.Name = "HPInner"
hpInner.Size = UDim2.new(1, -10, 1, -10)
hpInner.Position = UDim2.new(0, 5, 0, 5)
hpInner.BackgroundTransparency = 1
hpInner.Parent = hpContainer

-- Заголовок HP
local hpTitle = Instance.new("TextLabel")
hpTitle.Name = "HPTitle"
hpTitle.Size = UDim2.new(0, 28, 1, 0)
hpTitle.Position = UDim2.new(0, 0, 0, 0)
hpTitle.BackgroundTransparency = 1
hpTitle.Text = "HP:"
hpTitle.TextColor3 = Color3.fromRGB(180, 180, 180)
hpTitle.TextSize = 15
hpTitle.Font = Enum.Font.SourceSansSemibold
hpTitle.TextXAlignment = Enum.TextXAlignment.Left
hpTitle.Parent = hpInner

-- HP текущее значение
local hpCurrent = Instance.new("TextLabel")
hpCurrent.Name = "HPCurrent"
hpCurrent.Size = UDim2.new(0, 45, 1, 0)
hpCurrent.Position = UDim2.new(0, 32, 0, 0)
hpCurrent.BackgroundTransparency = 1
hpCurrent.Text = "--"
hpCurrent.TextColor3 = Color3.fromRGB(255, 100, 100)
hpCurrent.TextSize = 15
hpCurrent.Font = Enum.Font.SourceSansBold
hpCurrent.TextXAlignment = Enum.TextXAlignment.Left
hpCurrent.Parent = hpInner

-- Разделитель текущего и максимального HP
local hpDivider = Instance.new("TextLabel")
hpDivider.Name = "HPDivider"
hpDivider.Size = UDim2.new(0, 12, 1, 0)
hpDivider.Position = UDim2.new(0, 77, 0, 0)
hpDivider.BackgroundTransparency = 1
hpDivider.Text = "/"
hpDivider.TextColor3 = Color3.fromRGB(80, 80, 80)
hpDivider.TextSize = 15
hpDivider.Font = Enum.Font.SourceSansSemibold
hpDivider.TextXAlignment = Enum.TextXAlignment.Center
hpDivider.Parent = hpInner

-- HP максимальное значение
local hpMax = Instance.new("TextLabel")
hpMax.Name = "HPMax"
hpMax.Size = UDim2.new(0, 45, 1, 0)
hpMax.Position = UDim2.new(0, 89, 0, 0)
hpMax.BackgroundTransparency = 1
hpMax.Text = "--"
hpMax.TextColor3 = Color3.fromRGB(100, 100, 255)
hpMax.TextSize = 15
hpMax.Font = Enum.Font.SourceSansBold
hpMax.TextXAlignment = Enum.TextXAlignment.Left
hpMax.Parent = hpInner

-- ============ СИСТЕМА ПЕРЕТАСКИВАНИЯ ============
local dragging = false
local dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    mainContainer.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

mainContainer.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainContainer.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

mainContainer.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- ============ СИСТЕМА FPS ============
local fps = 0
local frames = 0
local lastTime = 0

local function updateFPS(deltaTime)
    frames = frames + 1
    
    if lastTime == 0 then
        lastTime = tick()
    end
    
    if tick() - lastTime >= 0.5 then
        fps = math.floor(frames / (tick() - lastTime))
        frames = 0
        lastTime = tick()
        
        fpsValue.Text = tostring(fps)
        
        if fps >= 60 then
            fpsValue.TextColor3 = Color3.fromRGB(100, 255, 100)
        elseif fps >= 30 then
            fpsValue.TextColor3 = Color3.fromRGB(255, 255, 100)
        else
            fpsValue.TextColor3 = Color3.fromRGB(255, 100, 100)
        end
    end
end

-- ============ СИСТЕМА PING ============
local function updatePing()
    local stats = game:GetService("Stats")
    local network = stats:FindFirstChild("Network")
    
    if network then
        local ping = math.floor(network.ServerStatsItem["Data Ping"]:GetValue())
        
        pingValue.Text = tostring(ping)
        
        if ping < 80 then
            pingValue.TextColor3 = Color3.fromRGB(100, 255, 100)
        elseif ping < 150 then
            pingValue.TextColor3 = Color3.fromRGB(255, 255, 100)
        else
            pingValue.TextColor3 = Color3.fromRGB(255, 100, 100)
        end
    else
        pingValue.Text = "--"
        pingValue.TextColor3 = Color3.fromRGB(180, 180, 180)
    end
end

-- ============ СИСТЕМА HP ============
local function updateHP()
    local character = player.Character
    if character then
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            local currentHP = math.floor(humanoid.Health)
            local maxHP = math.floor(humanoid.MaxHealth)
            
            hpCurrent.Text = tostring(currentHP)
            hpMax.Text = tostring(maxHP)
            
            local hpPercent = currentHP / maxHP
            if hpPercent >= 0.7 then
                hpCurrent.TextColor3 = Color3.fromRGB(100, 255, 100)
            elseif hpPercent >= 0.3 then
                hpCurrent.TextColor3 = Color3.fromRGB(255, 255, 100)
            else
                hpCurrent.TextColor3 = Color3.fromRGB(255, 100, 100)
            end
        else
            hpCurrent.Text = "--"
            hpMax.Text = "--"
            hpCurrent.TextColor3 = Color3.fromRGB(180, 180, 180)
        end
    else
        hpCurrent.Text = "--"
        hpMax.Text = "--"
        hpCurrent.TextColor3 = Color3.fromRGB(180, 180, 180)
    end
end

-- ============ ОБНОВЛЕНИЕ СТАТИСТИК ============
RunService.RenderStepped:Connect(updateFPS)

local pingUpdateTime = 0
local hpUpdateTime = 0
RunService.RenderStepped:Connect(function(deltaTime)
    pingUpdateTime = pingUpdateTime + deltaTime
    hpUpdateTime = hpUpdateTime + deltaTime
    
    if pingUpdateTime >= 1 then
        updatePing()
        pingUpdateTime = 0
    end
    
    if hpUpdateTime >= 0.1 then
        updateHP()
        hpUpdateTime = 0
    end
end)

updatePing()
updateHP()

-- ============ ОБНОВЛЕНИЕ ПРИ СМЕНЕ ПЕРСОНАЖА ============
player.CharacterAdded:Connect(function(character)
    wait(1)
    updateHP()
end)
